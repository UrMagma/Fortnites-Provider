<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fortnite Modding Vault</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<style>
body { background: #000; position: relative; z-index: 1; }
/* Global page glow overlay */
/* Blue glow overlay */
.page-glow-overlay {
  pointer-events: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 0;
  background: radial-gradient(
    circle at var(--x,50%) var(--y,50%),
    rgba(59,130,246,0.08) 0%,
    rgba(37,99,235,0.05) 40%,
    transparent 80%
  );
  transition: background-position 0.2s;
}
/* Outline glow for cards and buttons */
.outline-glow {
  position: relative;
  z-index: 1;
}
.outline-glow::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  padding: 2px; /* thickness of the outline */
  background: radial-gradient(
    circle at var(--x, 100%) var(--y, 100%),
    var(--theme-card-glow) 0%,
    transparent 80%
  );
  -webkit-mask: 
    linear-gradient(#fff 0 0) content-box, 
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s ease;
}
.outline-glow.active::before {
  opacity: 1;
}
/* Project Card and Button with dark gray borders, no gradient glow */
.card-gradient-border {
  border-radius: 1.5rem;
  background-clip: padding-box;
  position: relative;
  box-shadow: none;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding-left: 1.5rem;
  padding-right: 1.5rem;
  background-color: transparent;
  isolation: isolate;
  -webkit-mask-composite: exclude;
  mask-composite: exclude;
  -webkit-mask-composite: exclude;
  position: relative;
  z-index: 1;
}
/* Removed .card-glow-overlay from buttons and cards */
/* Button styles */
button.w-full.text-left {
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding-left: 1.5rem;
  padding-right: 1.5rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  border-radius: 0.75rem; /* normal rounded corners */
  overflow: visible; /* remove overflow hidden to prevent pill effect */
  background-color: transparent;
  isolation: isolate;
  -webkit-mask-composite: exclude;
  mask-composite: exclude;
  -webkit-mask-composite: exclude;
  position: relative;
  z-index: 1;
}
/* Remove group hover pill effect */
/* Sidebar button icon */
.sidebar-icon-img {
  width: 20px;
  height: 20px;
  border-radius: 0.5rem;
  object-fit: cover;
  background: transparent 95%;
  flex-shrink: 0;
  margin-right: 0.75rem;
}
/* Remove previous full sidebar glow, and add partial right-side glow */
.sidebar-right-glow {
  position: absolute;
  top: 0;
  right: 0;
  width: 2px;
  height: 100%;
  background: linear-gradient(
    180deg,
    var(--theme-card-glow) 0%,
    rgba(0,0,0,0) 50%,
    var(--theme-card-glow) 100%
  );
  filter: blur(4px);
  pointer-events: none;
  transition: background 0.3s ease;
  z-index: 3;
}
/* Remove sidebar right border */
aside {
  border-right: none !important;
}
</style>
</head>
<body class="bg-black text-white">
<div class="page-glow-overlay"></div>
<div id="root" style="position: relative; z-index: 1;"></div>
<script>
const e = React.createElement;
const { useState, useEffect, useRef } = React;

/* Data */
// ==========================
// How to add new projects:
// ==========================
// - Each key in the 'projects' object is a category, e.g. 'dll', 'backend', 'launcher', 'sdk', 'tools', etc.
// - To add a new project to a category, add a new object to the corresponding array.
// - Each project object can have:
//   - title: String (required)
//   - description: String (required)
//   - repo: String (optional, URL to repository)
//   - discord: String (optional, URL to Discord)
//
// Example: Adding new projects to multiple categories:
//
// projects.dll.push({
//   title: "Another DLL",
//   description: "Description for another DLL project.",
//   repo: "https://github.com/example/another-dll",
//   discord: "https://discord.gg/another"
// });
//
// projects.backend.push({
//   title: "Backend Project Example",
//   description: "A backend for Fortnite mods.",
//   repo: "https://github.com/example/backend",
//   discord: "https://discord.gg/backend"
// });
//
// - Projects added in this way will automatically show in the UI under their category tab.
// - You can add as many projects as you want to each category.
//
// ==========================
const projects = {
  dll: [
    {
      title: "Raider 3.5",
      description: "Fortnitev3.5 SDK based game server.",
      repo: "https://github.com/kem0x/raider3.5",
      image: "https://avatars.githubusercontent.com/u/19430119?v=4"
     // discordMemberCount: 1532 // Example count
    },
    {
      title: "Universal Walking Simulator",
      description: "Fortnite season 1-19 game server.",
      repo: "https://github.com/Milxnor/Universal-Walking-Simulator",
      image: "https://avatars.githubusercontent.com/u/84999745?v=4"
    },
    {
      title: "Cobalt",
      description: "Universal SSL Bypass for Fortnite, made by Milxnor.",
      repo: "https://github.com/Milxnor/Cobalt",
      image: "https://avatars.githubusercontent.com/u/84999745?v=4"
    }
    // Add more DLL projects here
  ],
  projects: [
    {
      title: "Project Reboot",
      description: "Made by Milxnor, and many others.",
      repo: "https://github.com/Milxnor/Project-Reboot-3.0/tree/master",
      discord: "https://discord.gg/H9sGkxBThS",
      image: "https://pbs.twimg.com/profile_images/1934351954505052160/mUca_K1Q_400x400.jpg",
      discordMemberCount: 4820 // Example count
    },
    {
      title: "Era",
      description: "Project Era, the oldest hosting server. Made by dani, and more.",
      discord: "https://discord.gg/erafn",
      image: "https://cdn2.steamgriddb.com/grid/7eb374c4c89c32d0fa63c2b4af5eefdc.png"
    }
    // Add more 'projects' category projects here
  ],
  backend: [
    {
      title: "Lawin Server V1",
      description: "Fortnite backend, made by Lawin.",
      repo: "https://github.com/Lawin0129/LawinServer",
      image: "https://placehold.co/64x64/9333ea/fff?text=V1"
    },
    {
      title: "Lawin Server V2",
      description: "LawinServer V2 is a fortnite backend written in Node.js that features an account system and xmpp.",
      repo: "https://github.com/Lawin0129/LawinServerV2",
      image: "https://placehold.co/64x64/6d28d9/fff?text=V2"
    }
    // Add more backend projects here
  ],
  launcher: [
    // Add launcher projects here
  ],
  sdk: [
    // Add SDK projects here
  ],
  tools: [
    // Add tools projects here
  ]
};

const tabs = [
  { id: "announcements", label: "Announcements" },
  { id: "projectz", label: "Projects" },
  { id: "dll", label: "DLL" },
  { id: "backend", label: "Backend" },
  { id: "launcher", label: "Launcher" },
  { id: "sdk", label: "SDK" },
  { id: "tools", label: "Tools" }
  // Settings tab will be rendered separately at the bottom
];

/* Hook for page-level cursor-follow glow */
function usePageGlow() {
  useEffect(() => {
    const overlay = document.querySelector('.page-glow-overlay');
    if (!overlay) return;
    const onMove = (e) => {
      const x = (e.clientX / window.innerWidth) * 100;
      const y = (e.clientY / window.innerHeight) * 100;
      overlay.style.setProperty('--x', x + '%');
      overlay.style.setProperty('--y', y + '%');
    };
    window.addEventListener('mousemove', onMove);
    return () => window.removeEventListener('mousemove', onMove);
  }, []);
}

/* Components */
// Map tab id to example icon URL (replace with real images later)
const tabIcons = {
  announcements: "https://img.icons8.com/pastel-glyph/64/FFFFFF/bullhorn-megaphone--v2.png",
  dll: "https://img.icons8.com/ios-filled/50/FFFFFF/dll.png",
  backend: "https://img.icons8.com/ios-filled/100/FFFFFF/code.png",
  launcher: "https://img.icons8.com/ios-filled/100/FFFFFF/missile.png",
  sdk: "https://img.icons8.com/external-tal-revivo-light-tal-revivo/96/FFFFFF/external-skd-badge-logotype-isolated-on-white-background-development-light-tal-revivo.png",
  tools: "https://img.icons8.com/ios-filled/100/FFFFFF/maintenance.png",
  projects: "https://img.icons8.com/ios-filled/100/FFFFFF/ms-project.png",
  settings: "https://img.icons8.com/ios-filled/50/FFFFFF/settings.png"
};

function SettingsPanel({ setTheme, currentTheme }) {
  const themes = [
    { name: "Black & Blue", gradient: "blue", colors: { from: "#2563eb", to: "#60a5fa", hover: "#3b82f6" } },
    { name: "Black & Red", gradient: "red", colors: { from: "#dc2626", to: "#f87171", hover: "#ef4444" } },
    { name: "Black & Purple", gradient: "purple", colors: { from: "#9333ea", to: "#a78bfa", hover: "#a21caf" } }
  ];
  return (
    e('div', { className: "flex flex-col items-center space-y-4 p-4" },
      e('h2', { className: "text-xl font-bold text-white mb-4" }, "Select Theme"),
      themes.map(theme =>
        e('button', {
          key: theme.name,
          onClick: () => setTheme(theme.gradient),
          className:
            "w-full py-2 px-4 rounded-lg bg-gray-800 text-white transition-colors" +
            (currentTheme === theme.gradient ? " ring-2 ring-offset-2 ring-white" : ""),
          style: currentTheme === theme.gradient
            ? { background: `linear-gradient(90deg, ${theme.colors.from}, ${theme.colors.to})`, color: "#fff" }
            : undefined
        }, theme.name)
      )
    )
  );
}

// Removed useSidebarGlow and sidebar partial glow logic

function Sidebar({ activeTab, setActiveTab }) {
  const [activeIndex, setActiveIndex] = useState(null);
  // Using activeIndex to track which button is hovered/active

  return e('aside', {
      className: "w-60 bg-black/80 relative flex flex-col p-4"
    },
    e('h1', { className: "text-xl font-bold mb-8 text-white z-10 relative" }, "Project Hub"),
    e('nav', { className: "space-y-3 z-10 relative" },
      tabs.map((tab, index) => {
        const isActive = activeIndex === index;
        return e('button', {
          key: tab.id,
          className:
            [
              "w-full",
              "text-left",
              "p-3",
              "rounded-lg",
              "relative",
              "group",
              "bg-transparent",
              "flex",
              "items-center",
              "outline-glow",
              (isActive ? "active" : ""),
              (activeTab === tab.id ? "active" : ""),
            ].filter(Boolean).join(" "),
          onClick: ()=>setActiveTab(tab.id),
          onMouseEnter: () => setActiveIndex(index),
          onMouseLeave: () => setActiveIndex(null),
          onMouseMove: (event) => {
            const rect = event.currentTarget.getBoundingClientRect();
            const x = event.clientX;
            const y = event.clientY;
            // Calculate distance to element center
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const dist = Math.hypot(centerX - x, centerY - y);
            if (dist <= 100) {
              if (activeIndex !== index) setActiveIndex(index);
            } else {
              if (activeIndex === index) setActiveIndex(null);
            }
          },
          style: activeTab === tab.id ? { outline: `2px solid var(--theme-card-glow)` } : { outline: "none" }
        },
          // Sidebar icon image instead of purple circle
          e('img', {
            src: tabIcons[tab.id] || "https://placehold.co/20x20",
            alt: "",
            className: "sidebar-icon-img"
          }),
          e('span', { className:"relative z-10 text-white" }, tab.label)
        )
      })
    ),
    // Settings tab at the bottom of sidebar
    e('div', { className: "mt-auto flex flex-col z-10 relative" },
      e('button', {
        className:
          [
            "w-full",
            "text-left",
            "p-3",
            "rounded-lg",
            "relative",
            "group",
            "bg-transparent",
            "flex",
            "items-center",
            "outline-glow",
            (activeTab === "settings" ? "active" : "")
          ].filter(Boolean).join(" "),
        onClick: () => setActiveTab("settings"),
        onMouseEnter: () => setActiveIndex("settings"),
        onMouseLeave: () => setActiveIndex(null),
        style: activeTab === "settings" ? { outline: `2px solid var(--theme-card-glow)` } : { outline: "none" }
      },
        e('img', {
          src: tabIcons.settings,
          alt: "",
          className: "sidebar-icon-img"
        }),
        e('span', { className: "relative z-10 text-white" }, "Settings")
      )
    ),
    e('div', { className: "sidebar-right-glow" })
  );
}

const announcementsData = [
  {
    image: "https://pbs.twimg.com/media/Gv5zL-FXMAA_x1p.jpg:large",
    title: "Updates",
    text: "New animations, and color theme changer."
  },
  {
    image: "https://pbs.twimg.com/media/FmIZIQmXEAMr3Bq.jpg:large",
    title: "Ack",
    text: "Discord Member Count, card is currently broken."
  },
  {
    image: "https://www.therisingnews.com/wp-content/uploads/2024/03/GILT9hCWAAA-EtR.jpeg",
    title: "Reminder",
    text: "If you'd like to add a project please add me on discord @opensync"
  }
];

function Announcement() {
  const [currentIndex, setCurrentIndex] = useState(0);
  const total = announcementsData.length;
  const [active, setActive] = useState(false);
  const ref = useRef(null);

  const prev = () => {
    setCurrentIndex((currentIndex - 1 + total) % total);
  };

  const next = () => {
    setCurrentIndex((currentIndex + 1) % total);
  };

  const current = announcementsData[currentIndex];

  const handleMouseMove = (event) => {
    if (!ref.current) return;
    const rect = ref.current.getBoundingClientRect();
    const x = event.clientX;
    const y = event.clientY;
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    const dist = Math.hypot(centerX - x, centerY - y);
    if (dist <= 100) {
      if (!active) setActive(true);
      // Update CSS variables for gradient position
      const relX = x - rect.left;
      const relY = y - rect.top;
      ref.current.style.setProperty('--x', relX + 'px');
      ref.current.style.setProperty('--y', relY + 'px');
    } else {
      if (active) setActive(false);
    }
  };

  return e('div', {
    ref,
    className: `w-full h-full flex justify-center items-center relative outline-glow${active ? ' active' : ''}`,
    onMouseMove: handleMouseMove,
    onMouseLeave: () => setActive(false),
    onMouseEnter: () => setActive(true)
  },
    e('div', { className: "relative max-w-4xl flex flex-col justify-center items-center space-y-6 w-full h-full px-6" },
      e('img', { src: current.image, alt: current.title, className: "rounded-xl mx-auto max-w-full max-h-[60vh] object-contain" }),
      e('h2', { className: "text-4xl font-bold text-white" }, current.title),
      e('p', { className: "text-white text-lg max-w-3xl" }, current.text),
      e('div', { className: "absolute top-1/2 left-4 -translate-y-1/2 cursor-pointer text-white select-none text-3xl font-bold", onClick: prev, role: "button", tabIndex: 0, onKeyDown: (e) => { if(e.key === 'Enter') prev(); } },
        e('span', { className: "text-white" }, "‹")
      ),
      e('div', { className: "absolute top-1/2 right-4 -translate-y-1/2 cursor-pointer text-white select-none text-3xl font-bold", onClick: next, role: "button", tabIndex: 0, onKeyDown: (e) => { if(e.key === 'Enter') next(); } },
        e('span', { className: "text-white" }, "›")
      ),
      e('div', { className: "flex justify-center space-x-2 mt-6" },
        announcementsData.map((_, idx) =>
          e('span', {
            key: idx,
            className: `w-3 h-3 rounded-full cursor-pointer ${idx === currentIndex ? 'bg-blue-400' : 'bg-blue-900'} text-white`,
            onClick: () => setCurrentIndex(idx),
            role: "button",
            tabIndex: 0,
            onKeyDown: (e) => { if(e.key === 'Enter') setCurrentIndex(idx); }
          })
        )
      )
    )
  );
}

function ProjectCard({ title, description, repo, discord, image, onClick }) {
  const [active, setActive] = useState(false);
  const [expanded, setExpanded] = useState(false); // Track expansion
  const ref = useRef(null);

  const handleMouseMove = (event) => {
    if (!ref.current) return;
    const rect = ref.current.getBoundingClientRect();
    const x = event.clientX;
    const y = event.clientY;
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    const dist = Math.hypot(centerX - x, centerY - y);
    if (dist <= 100) {
      if (!active) setActive(true);
    } else {
      if (active) setActive(false);
    }
  };

  // Collapse if description is longer than 20 chars
  const showReadMore = description && description.length > 20;
  // Only show first 20 chars + ... when collapsed
  const collapsedDesc = description ? description.slice(0, 20) + "..." : "";

  // Animate height for expand/collapse and allow layout to reflow
  const cardStyle = {
    transition: "min-height 0.2s, box-shadow 0.2s",
    minHeight: expanded ? "8.5em" : "6.5em",
    cursor: onClick ? "pointer" : undefined
  };

  return e('div', {
    ref,
    className: `w-[200px] bg-transparent rounded-2xl shadow-xl p-8 text-center relative outline-glow group flex flex-col justify-center items-center transition-all duration-200${active ? ' active' : ''}`,
    style: cardStyle,
    onMouseEnter: () => setActive(true),
    onMouseLeave: () => setActive(false),
    onMouseMove: handleMouseMove,
    onClick: onClick
  },
    image && e('img', {
      src: image,
      alt: title + " logo",
      className: "w-16 h-16 mx-auto rounded mb-2 object-cover"
    }),
    e('h3', { className:"text-2xl font-bold mb-4 text-white" }, title),
    e('p', {
      className:"text-white mb-4 transition-all duration-200",
      style: expanded || !showReadMore
        ? {}
        : { overflow: 'hidden', whiteSpace: 'nowrap', textOverflow: 'ellipsis', minHeight: '1.75em' }
    },
      expanded || !showReadMore ? description : collapsedDesc
    ),
    showReadMore &&
      e('button', {
        onClick: (event) => { event.stopPropagation(); setExpanded(!expanded); },
        className: "text-sm text-blue-400 mt-2 hover:underline"
      }, e('span', { className: "text-white" }, expanded ? "Read Less" : "Read More")),
    e('div', { className:"flex justify-center space-x-2 mt-2" },
      repo && e('a', {
        href:repo,
        target:"_blank",
        rel:"noopener noreferrer",
        className:"flex items-center space-x-2 hover:text-blue-400",
        onClick: (event) => event.stopPropagation()
      },
        e('img', {
          src: "https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg",
          alt: "GitHub",
          style: { width: 20, height: 20, display: "inline-block", filter: "invert(1)" },
          className: "inline-block"
        })
      ),
      discord && e('a', {
        href:discord,
        target:"_blank",
        rel:"noopener noreferrer",
        className:"flex items-center space-x-2 hover:text-blue-400",
        onClick: (event) => event.stopPropagation()
      },
        e('img', {
          src: "https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/discord.svg",
          alt: "Discord",
          style: { width: 20, height: 20, display: "inline-block", filter: "invert(1)" },
          className: "inline-block"
        })
      )
    )
  );
}

function ProjectGrid({ projects, onProjectClick }) {
  // Align cards to start right next to sidebar and flow left to right, with tight gap,
  // wrap to next line as needed, and cards close together.
  return e('div', {
    className: "flex flex-wrap justify-start gap-2"
  },
    projects.map((p, i) =>
      e(ProjectCard, {
        ...p,
        key: i,
        onClick: onProjectClick ? (() => onProjectClick(p)) : undefined
      })
    )
  );
}

// Side panel for project details
function ProjectSidePanel({ project, onClose }) {
  const [visible, setVisible] = useState(false);
  const [shouldRender, setShouldRender] = useState(true);
  const panelRef = useRef(null);

  // Animate in on mount
  useEffect(() => {
    setShouldRender(true);
    setTimeout(() => setVisible(true), 10);
    return () => {};
  }, []);

  // Handle close: animate out, then unmount
  const handleClose = () => {
    setVisible(false);
    setTimeout(() => {
      setShouldRender(false);
      onClose && onClose();
    }, 300);
  };

  // If not rendering, don't show
  if (!shouldRender) return null;

  return e('div', {
    ref: panelRef,
    className:
      "fixed top-0 right-0 h-full w-96 bg-transparent p-6 flex flex-col overflow-auto z-50 backdrop-blur-sm transition-transform duration-300 ease-in-out",
    style: {
      boxShadow: "0 0 60px 0 rgba(59,130,246,0.12)",
      transform: visible ? "translateX(0)" : "translateX(100%)",
      pointerEvents: visible ? "auto" : "none"
    }
  },
    e('div', { className: "relative flex flex-col flex-1" },
      // Close button
      e('button', {
        onClick: handleClose,
        className: "absolute top-2 right-2 text-white bg-black/40 rounded-full w-8 h-8 flex items-center justify-center hover:bg-blue-700/60 outline-glow z-10"
      }, e('span', { className: "text-2xl font-bold" }, "×")),
      // Panel content with gradient/outline inside
      e('div', { className: "flex flex-col items-center outline-glow active rounded-2xl p-4 mt-6 bg-black/30 relative" },
        project.logo || project.image
          ? e('img', {
              src: project.logo || project.image,
              alt: project.title + " logo",
              className: "w-20 h-20 rounded-xl mb-4 object-cover shadow-lg"
            })
          : null,
        e('h2', { className: "text-2xl font-bold mb-2 text-white text-center" }, project.title),
        e('p', { className: "mb-4 text-white text-center" }, project.description),
        e('div', { className: "flex gap-3 mb-4" },
          project.repo && e('a', {
            href: project.repo,
            target: "_blank",
            rel: "noopener noreferrer",
            className: "hover:text-blue-400"
          }, e('img', {
            src: "https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg",
            alt: "GitHub",
            style: { width: 24, height: 24, filter: "invert(1)" }
          })),
          project.discord && e('a', {
            href: project.discord,
            target: "_blank",
            rel: "noopener noreferrer",
            className: "hover:text-blue-400"
          }, e('img', {
            src: "https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/discord.svg",
            alt: "Discord",
            style: { width: 24, height: 24, filter: "invert(1)" }
          }))
        ),
        // Discord member count card
        project.discordMemberCount && e('div', {
          className: "outline-glow active bg-black/30 rounded-2xl p-4 mt-4 w-full text-center"
        },
          e('h3', { className: "text-lg font-bold text-white" }, "Discord Members"),
          e('p', { className: "text-white text-lg" }, project.discordMemberCount)
        )
      )
    )
  );
}

function App() {
  usePageGlow();
  const [activeTab, _setActiveTab] = useState("announcements");
  const [selectedProject, setSelectedProject] = useState(null);
  const [theme, setTheme] = useState("blue"); // default theme

  // Wrap setActiveTab to also close project panel
  const setActiveTab = (tab) => {
    _setActiveTab(tab);
    setSelectedProject(null);
  };

  // Map theme to colors for gradients, glows, hovers
  const themeConfig = {
    blue: {
      gradientFrom: "#2563eb",
      gradientTo: "#60a5fa",
      hover: "#3b82f6",
      shadow: "rgba(59,130,246,0.3)",
      cardGlow: "rgba(59,130,246,0.3)",
      dotActive: "bg-blue-400",
      dotInactive: "bg-blue-900"
    },
    red: {
      gradientFrom: "#dc2626",
      gradientTo: "#f87171",
      hover: "#ef4444",
      shadow: "rgba(239,68,68,0.3)",
      cardGlow: "rgba(239,68,68,0.3)",
      dotActive: "bg-red-400",
      dotInactive: "bg-red-900"
    },
    purple: {
      gradientFrom: "#9333ea",
      gradientTo: "#a78bfa",
      hover: "#a21caf",
      shadow: "rgba(168,139,250,0.3)",
      cardGlow: "rgba(168,139,250,0.3)",
      dotActive: "bg-purple-400",
      dotInactive: "bg-purple-900"
    }
  };
  const themeVars = themeConfig[theme];

  // Determine which projects list to show for grid
  let gridProjects = [];
  if (activeTab === "dll") gridProjects = projects.dll;
  else if (activeTab === "backend") gridProjects = projects.backend;
  else if (activeTab === "launcher") gridProjects = projects.launcher;
  else if (activeTab === "sdk") gridProjects = projects.sdk;
  else if (activeTab === "projectz") gridProjects = projects.projects;
  else if (activeTab === "tools") gridProjects = projects.tools;

  // For overlay/shrink effect
  const panelOpen = !!selectedProject;

  // Set CSS variables for theme on body or root
  useEffect(() => {
    document.body.style.setProperty('--theme-gradient-from', themeVars.gradientFrom);
    document.body.style.setProperty('--theme-gradient-to', themeVars.gradientTo);
    document.body.style.setProperty('--theme-hover', themeVars.hover);
    document.body.style.setProperty('--theme-shadow', themeVars.shadow);
    document.body.style.setProperty('--theme-card-glow', themeVars.cardGlow);
    document.documentElement.style.setProperty('--theme-card-glow', themeVars.cardGlow);
  }, [theme, themeVars]);

  // Custom Announcement and ProjectCard with theme support
  function ThemedAnnouncement() {
    const [currentIndex, setCurrentIndex] = useState(0);
    const total = announcementsData.length;
    const [active, setActive] = useState(false);
    const ref = useRef(null);
    const prev = () => setCurrentIndex((currentIndex - 1 + total) % total);
    const next = () => setCurrentIndex((currentIndex + 1) % total);
    const current = announcementsData[currentIndex];
    const handleMouseMove = (event) => {
      if (!ref.current) return;
      const rect = ref.current.getBoundingClientRect();
      const x = event.clientX;
      const y = event.clientY;
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      const dist = Math.hypot(centerX - x, centerY - y);
      if (dist <= 100) {
        if (!active) setActive(true);
        // Update CSS variables for gradient position
        const relX = x - rect.left;
        const relY = y - rect.top;
        ref.current.style.setProperty('--x', relX + 'px');
        ref.current.style.setProperty('--y', relY + 'px');
      } else {
        if (active) setActive(false);
      }
    };
    return e('div', {
      ref,
      className: `w-full h-full flex justify-center items-center relative outline-glow${active ? ' active' : ''}`,
      onMouseMove: handleMouseMove,
      onMouseLeave: () => setActive(false),
      onMouseEnter: () => setActive(true),
      style: {
        '--theme-gradient-from': themeVars.gradientFrom,
        '--theme-gradient-to': themeVars.gradientTo
      }
    },
      e('div', { className: "relative max-w-4xl flex flex-col justify-center items-center space-y-6 w-full h-full px-6" },
        e('img', { src: current.image, alt: current.title, className: "rounded-xl mx-auto max-w-full max-h-[60vh] object-contain" }),
        e('h2', { className: "text-4xl font-bold text-white" }, current.title),
        e('p', { className: "text-white text-lg max-w-3xl" }, current.text),
        e('div', { className: "absolute top-1/2 left-4 -translate-y-1/2 cursor-pointer text-white select-none text-3xl font-bold", onClick: prev, role: "button", tabIndex: 0, onKeyDown: (e) => { if(e.key === 'Enter') prev(); } },
          e('span', { className: "text-white" }, "‹")
        ),
        e('div', { className: "absolute top-1/2 right-4 -translate-y-1/2 cursor-pointer text-white select-none text-3xl font-bold", onClick: next, role: "button", tabIndex: 0, onKeyDown: (e) => { if(e.key === 'Enter') next(); } },
          e('span', { className: "text-white" }, "›")
        ),
        e('div', { className: "flex justify-center space-x-2 mt-6" },
          announcementsData.map((_, idx) =>
            e('span', {
              key: idx,
              className: `w-3 h-3 rounded-full cursor-pointer ${idx === currentIndex ? themeVars.dotActive : themeVars.dotInactive} text-white`,
              onClick: () => setCurrentIndex(idx),
              role: "button",
              tabIndex: 0,
              onKeyDown: (e) => { if(e.key === 'Enter') setCurrentIndex(idx); }
            })
          )
        )
      )
    );
  }

  function ThemedProjectCard(props) {
    // Same logic as ProjectCard but with dynamic theme on outline-glow
    const [active, setActive] = useState(false);
    const [expanded, setExpanded] = useState(false);
    const ref = useRef(null);
    const handleMouseMove = (event) => {
      if (!ref.current) return;
      const rect = ref.current.getBoundingClientRect();
      const x = event.clientX;
      const y = event.clientY;
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      const dist = Math.hypot(centerX - x, centerY - y);
      if (dist <= 100) {
        if (!active) setActive(true);
      } else {
        if (active) setActive(false);
      }
    };
    const showReadMore = props.description && props.description.length > 20;
    const collapsedDesc = props.description ? props.description.slice(0, 20) + "..." : "";
    const cardStyle = {
      transition: "min-height 0.2s, box-shadow 0.2s",
      minHeight: expanded ? "8.5em" : "6.5em",
      cursor: props.onClick ? "pointer" : undefined,
      '--theme-gradient-from': themeVars.gradientFrom,
      '--theme-gradient-to': themeVars.gradientTo
    };
    return e('div', {
      ref,
      className: `w-[200px] bg-transparent rounded-2xl shadow-xl p-8 text-center relative outline-glow group flex flex-col justify-center items-center transition-all duration-200${active ? ' active' : ''}`,
      style: cardStyle,
      onMouseEnter: () => setActive(true),
      onMouseLeave: () => setActive(false),
      onMouseMove: handleMouseMove,
      onClick: props.onClick
    },
      props.image && e('img', {
        src: props.image,
        alt: props.title + " logo",
        className: "w-16 h-16 mx-auto rounded mb-2 object-cover"
      }),
      e('h3', { className:"text-2xl font-bold mb-4 text-white" }, props.title),
      e('p', {
        className:"text-white mb-4 transition-all duration-200",
        style: expanded || !showReadMore
          ? {}
          : { overflow: 'hidden', whiteSpace: 'nowrap', textOverflow: 'ellipsis', minHeight: '1.75em' }
      },
        expanded || !showReadMore ? props.description : collapsedDesc
      ),
      showReadMore &&
        e('button', {
          onClick: (event) => { event.stopPropagation(); setExpanded(!expanded); },
          className: "text-sm mt-2 hover:underline",
          style: { color: themeVars.gradientFrom }
        }, e('span', { className: "text-white" }, expanded ? "Read Less" : "Read More")),
      e('div', { className:"flex justify-center space-x-2 mt-2" },
        props.repo && e('a', {
          href:props.repo,
          target:"_blank",
          rel:"noopener noreferrer",
          className:"flex items-center space-x-2 hover:text-blue-400",
          onClick: (event) => event.stopPropagation()
        },
          e('img', {
            src: "https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg",
            alt: "GitHub",
            style: { width: 20, height: 20, display: "inline-block", filter: "invert(1)" },
            className: "inline-block"
          })
        ),
        props.discord && e('a', {
          href:props.discord,
          target:"_blank",
          rel:"noopener noreferrer",
          className:"flex items-center space-x-2 hover:text-blue-400",
          onClick: (event) => event.stopPropagation()
        },
          e('img', {
            src: "https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/discord.svg",
            alt: "Discord",
            style: { width: 20, height: 20, display: "inline-block", filter: "invert(1)" },
            className: "inline-block"
          })
        )
      )
    );
  }

  function ThemedProjectGrid({ projects, onProjectClick }) {
    // Custom handler to close and open the side panel smoothly
    const handleCardClick = (project) => {
      setSelectedProject(null);
      setTimeout(() => {
        setSelectedProject(project);
      }, 20);
    };
    return e('div', {
      className: "flex flex-wrap justify-start gap-2"
    },
      projects.map((p, i) =>
        e(ThemedProjectCard, {
          ...p,
          key: i,
          onClick: onProjectClick ? (() => handleCardClick(p)) : undefined
        })
      )
    );
  }

  // SettingsPanel
  function ThemedSettingsPanel(props) {
    return e(SettingsPanel, { ...props, currentTheme: theme });
  }

  // Main return
  return e('div', { className: "flex h-screen text-white relative", style: { '--theme-gradient-from': themeVars.gradientFrom, '--theme-gradient-to': themeVars.gradientTo } },
    e(Sidebar, { activeTab, setActiveTab }),
    e('main', {
      className:
        "flex-1 overflow-y-auto p-8 flex flex-col gap-2 transition-all duration-300" +
        (panelOpen ? " scale-95 blur-sm pointer-events-none select-none opacity-70" : ""),
      style: panelOpen ? { filter: "blur(2px)", transition: "all 0.3s" } : {}
    },
      activeTab === "settings"
        ? e(ThemedSettingsPanel, { setTheme })
        : activeTab === "announcements"
          ? e(ThemedAnnouncement)
          : gridProjects.length > 0
            ? e(ThemedProjectGrid, { projects: gridProjects, onProjectClick: setSelectedProject })
            : null
    ),
    panelOpen && e(ProjectSidePanel, { project: selectedProject, onClose: () => setSelectedProject(null) })
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(e(App));
</script>
</body>
</html>